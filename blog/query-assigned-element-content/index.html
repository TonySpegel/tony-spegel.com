<!DOCTYPE html>

<!doctype html>
<html lang="de">
  
  <head>
  
  








<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Einen Decorator für Inhalte eines Slots entwickeln</title>
<meta name="description" content="Ein ClassAccessor-Decorator für Web Components, welcher eine Property in einen Getter konvertiert, um den Inhalt &lt;slot&gt; zugewiesener Elemente einfacher verarbeiten zu können.">
<meta name="generator" content="Eleventy v2.0.1">
<meta name="theme-color" content="#d5d5ff" media="(prefers-color-scheme: light)">
<meta property="og:title" content="Einen Decorator für Inhalte eines Slots entwickeln">
<meta property="og:description" content="Ein ClassAccessor-Decorator für Web Components, welcher eine Property in einen Getter konvertiert, um den Inhalt &lt;slot&gt; zugewiesener Elemente einfacher verarbeiten zu können.">

  <meta property="og:image" content="https://tony-spegel.com/img/2023/query-assigned-element-content/queryAssignedElementContentDemo.png">

<meta name="version" content="6.0.1">


  

  <style>
    
      *{margin:0;padding:0}*,:after,:before{box-sizing:border-box}h1{font-size:2em;margin:var(--base-gap) 0}p:not(.post-summary){line-height:1.9;font-size:clamp(1rem, .96rem + .18vw, 1.125rem);margin-block-end:var(--base-gap)}.glass{position:fixed;width:100vw;height:100vh;background-color:var(--glass-tint);backdrop-filter:blur(70px);z-index:0}.bubble{border-radius:65% 41% 48% 61%/61% 47% 57% 43%;width:var(--bubble-size);height:var(--bubble-size);background-color:var(--bubble-1--color-1);background-image:linear-gradient(19deg,var(--bubble-1--color-1) 0,var(--bubble-1--color-2) 100%);z-index:-1;position:fixed;right:-35px;top:-50px}.bubble-2{border-radius:72% 80% 70% 63%/83% 50% 100% 43%;width:var(--bubble-size);height:var(--bubble-size);background-color:var(--bubble-2--color-1);background-image:linear-gradient(226deg,var(--bubble-2--color-1) 0,var(--bubble-2--color-2) 100%);z-index:-1;bottom:-120px;position:fixed}#site-header{position:sticky;top:0;line-height:1;z-index:2}#site-header.opaque{background-color:var(--header-bg-color);border-bottom:2px solid var(--surface-4)}#site-header.opaque .logo{box-shadow:var(--shadow-2)}.logo{transition:transform ease .5s,box-shadow ease .5s}#site-header>*{margin:0}#site-header>nav{display:flex;align-items:center;justify-content:space-between;height:var(--header-height);padding:var(--base-gap)}.logo{display:flex;gap:var(--base-gap);align-items:center;border-radius:15px;padding:var(--logo-padding);width:var(--logo-size);height:var(--logo-size);transition:transform .1s ease-in-out;aspect-ratio:1/1;border:1px solid transparent;background-color:var(--logo-bg-color)}.logo img{width:100%;height:100%}#btn-theme-selection{border-radius:50%;border:2px solid hsla(281,53%,97%,.63);width:25px;aspect-ratio:1;background:linear-gradient(-45deg,#ca98e1,#20d4fc);transition:border .5s ease-out}#btn-theme-selection:is(:focus,:hover){border-color:hsla(281,100%,63%,.75)}:where(html){--base-gap:16px;--base-radius:8px;--site-max-width:1280px;--site-width:960px;--base-line-height:1.25;--logo-size:56px;--logo-padding:2px;--header-height:100px;--shadow-color:220 3% 15%;--shadow-strength:1%;--shadow-2:0 3px 5px -2px hsl(var(--shadow-color) /
          calc(var(--shadow-strength) + 3%)),0 7px 14px -5px hsl(var(--shadow-color) / calc(var(--shadow-strength) + 5%));--tag-border-radius:18px;--detail-summary-icon-size:24px}:where(h1,h2,h3,h4,h5,h6){line-height:var(--base-line-height)}theme-switch{--base-gap:16px}theme-switch:not(:defined) [slot]{display:none}toc-observer ol{list-style-type:none;line-height:1;padding:0}toc-observer ol:not(:first-child){padding-inline:0.85em}toc-observer a{display:flex;border-left:2px solid var(--toc-item-border-default-color);padding:calc(var(--base-gap)/ 2) var(--base-gap);color:var(--text-color-1);transition:all 50ms ease-in-out;text-decoration:none}toc-observer a:is(:hover,:focus,.toc-active){border-left-color:var(--toc-item-border-active-color)}[theme-preference=dark] .dropdown__toc{border:1px solid var(--surface-4);background-color:var(--surface-5)}theme-switch{--base-gap:16px}theme-switch:not(:defined) [slot]{display:none}toc-observer ol{list-style-type:none;line-height:1;padding:0}toc-observer ol:not(:first-child){padding-inline:0.85em}toc-observer a{display:flex;border-left:2px solid var(--toc-item-border-default-color);padding:calc(var(--base-gap)/ 2) var(--base-gap);color:var(--text-color-1);transition:all 50ms ease-in-out;text-decoration:none}toc-observer a:is(:hover,:focus,.toc-active){border-left-color:var(--toc-item-border-active-color)}[theme-preference=dark] .dropdown__toc{border:1px solid var(--surface-4);background-color:var(--surface-5)}:where(html){--shade-50:hsla(281, 53%, 97%, 1);--shade-50-glass:hsla(281, 53%, 97%, 0.63);--shade-100:hsla(281, 56%, 94%, 1);--shade-200:hsla(281, 56%, 84%, 1);--shade-300:hsla(281, 55%, 74%, 1);--shade-400:hsla(281, 55%, 55%, 1);--shade-500:hsla(281, 100%, 35%, 1);--shade-600:hsla(281, 100%, 32%, 1);--shade-700:hsla(281, 100%, 27%, 1);--shade-800:hsla(281, 100%, 21%, 1);--shade-900:hsla(281, 100%, 16%, 1);--text-1-light:var(--shade-800);--text-2-light:var(--shade-900);--surface-1-light:var(--shade-300);--surface-2-light:var(--shade-200);--surface-3-light:var(--shade-100);--surface-4-light:var(--shade-600);--surface-5-light:var(--surface-4-light);--border-light:var(--shade-200);--bubble-size:350px;--bubble-1--color-1:hsl(191, 98%, 56%);--bubble-1--color-2:hsl(281, 100%, 56%);--bubble-2--color-1:hsl(338, 78%, 48%);--bubble-2--color-2:hsl(199, 98%, 48%);--lavender-blue-1:#e6e6ff;--lavender-blue-2:#ccc9ff;--lavender-blue-3:#b3b3ff;--lavender-blue-4:#9996ff;--lavender-blue-5:#bbb9fe;--text-color-1--light:var(--shade-900);--glass-tint--light:hsl(200deg 100% 96% / 67%);--header-bg-color--light:#d5d5ff;--logo-bg-color--light:var(--lavender-blue-1);--hr-color--light:var(--lavender-blue-2);--disclaimer-badge-border--light:hsl(53.88deg 100% 80.78%);--disclaimer-badge-bg--light:hsl(54deg 100% 73%);--disclaimer-badge-text--light:var(--text-color-1--light);--disclaimer-box-border-color--light:#bbdefb;--disclaimer-box-bg-color--light:hsl(205.38deg 86.67% 94.12%);--details-summary-border-color--light:hsl(146deg 87.42% 65.38%);--details-summary-bg-color--light:hsl(146deg 87.42% 80.38%);--details-summary-bg-color-active--light:hsl(146deg 87.42% 70.38%);--details-summary-font-color--light:#000;--tag-border-color--light:var(--lavender-blue-2);--tag-bg-color--light:#d5d5ff;--tag-bg-color-active--light:var(--lavender-blue-1);--tag-font-color--light:var(--text-color-1--light);--code-bg-color-inline--light:var(--lavender-blue-1);--kbd-border-color--light:var(--lavender-blue-3);--kbd-bg-color--light:var(--lavender-blue-1);--radio-container-badge-bg-color--light:var(--lavender-blue-2);--radio-container-border-color--light:var(--lavender-blue-2);--radio-container-bg-color--light:var(--lavender-blue-1);--post-card-border-color--light:var(--lavender-blue-2);--post-card-bg-color--light:#f0efff;--social-link-border-color--light:var(--lavender-blue-2);--social-link-bg-color--light:var(--tag-bg-color--light);--social-link-bg-color-active--light:var(--tag-bg-color-active--light);--toc-item-border-default-color--light:var(--lavender-blue-2);--toc-item-border-active-color--light:var(--surface-4);--toc-dropdown-border-color--light:var(--lavender-blue-5);--toc-dropdown-bg--light:var(--lavender-blue-1);--toc-dropdown-icon-color-filter-value--light:0;--dialog-bg-color--light:var(--lavender-blue-1);--dialog-border-color--light:var(--lavender-blue-4);--themes-border-color--light:var(--lavender-blue-2);--control-color--light:var(--lavender-blue-3);--control-interaction-color--light:var(--lavender-blue-2);--circle-border-color--light:var(--lavender-blue-4);--circle-bg-color--light:var(--lavender-blue-1);--circle-bg-color-checked--light:var(--lavender-blue-3);--circle-wave--light:#000;--checkbox-border-color--light:var(--lavender-blue-4);--checkbox-bg-color--light:var(--lavender-blue-1);--checkbox-bg-color-checked--light:var(--lavender-blue-2);--checkmark-color--light:var(--lavender-blue-1);--deep-purple-1:hsl(281, 56%, 10%);--deep-purple-2:hsl(281, 60%, 15%);--deep-purple-3:hsl(281, 60%, 20%);--deep-purple-4:hsl(281, 60%, 25%);--deep-purple-5:hsl(262, 86%, 8%);--text-color-1--dark:#fff;--glass-tint--dark:hsla(286, 86%, 6%, 0.657);--header-bg-color--dark:var(--deep-purple-2);--logo-bg-color--dark:var(--deep-purple-3);--hr-color--dark:var(--deep-purple-4);--disclaimer-badge-border--dark:hsl(53.88deg 100% 80.78%);--disclaimer-badge-bg--dark:hsl(54deg 100% 73%);--disclaimer-badge-text--dark:#000;--disclaimer-box-border-color--dark:#bbdefb;--disclaimer-box-bg-color--dark:hsl(205.38deg 64.06% 21.67%);--tag-border-color--dark:none;--tag-bg-color--dark:var(--deep-purple-3);--tag-bg-color-active--dark:var(--deep-purple-2);--tag-font-color--dark:var(--text-color-1--dark);--code-bg-color-inline--dark:var(--deep-purple-3);--kbd-border-color--dark:var(--deep-purple-4);--kbd-bg-color--dark:var(--deep-purple-3);--radio-container-badge-bg-color--dark:var(--deep-purple-2);--radio-container-border-color--dark:var(--deep-purple-1);--radio-container-bg-color--dark:var(--deep-purple-3);--post-card-border-color--dark:var(--deep-purple-4);--post-card-bg-color--dark:var(--deep-purple-1);--social-link-border-color--dark:var(--deep-purple-4);--social-link-bg-color--dark:var(--tag-bg-color--dark);--social-link-bg-color-active--dark:var(--tag-bg-color-active--dark);--toc-item-border-default-color--dark:var(--deep-purple-4);--toc-item-border-active-color--dark:var(--shade-50);--toc-dropdown-border-color--dark:var(--lavender-blue-5);--toc-dropdown-bg-color--dark:var(--deep-purple-5);--toc-dropdown-icon-color-filter-value--dark:1;--dialog-border-color--dark:var(--deep-purple-2);--dialog-bg-color--dark:var(--deep-purple-5);--themes-border-color--dark:var(--deep-purple-3);--circle-border-color--dark:#eedcf530;--circle-bg-color--dark:#2a1d5445;--circle-bg-color-checked--dark:var(--deep-purple-3);--circle-wave--dark:#fff;--control-color--dark:var(--deep-purple-3);--control-interaction-color--dark:var(--deep-purple-2);--checkbox-border-color--dark:var(--deep-purple-3);--checkbox-bg-color--dark:#402e7e45;--checkbox-bg-color-checked--dark:var(--deep-purple-3);--checkmark-color--dark:#fff;--text-1-dark:hsl(0, 0%, 90%);--text-2-dark:hsl(0, 0%, 95%);--border-dark:var(--shade-800)}:where(html),[theme-preference=light]{color-scheme:light;--surface-1:var(--surface-1-light);--surface-2:var(--surface-2-light);--surface-3:var(--surface-3-light);--surface-4:var(--surface-4-light);--surface-5:var(--surface-4-light);--text-color-1:var(--text-color-1--light);--header-bg-color:var(--header-bg-color--light);--logo-bg-color:var(--logo-bg-color--light);--glass-tint:var(--glass-tint--light);--hr-color:var(--hr-color--light);--disclaimer-badge-border:var(--disclaimer-badge-border--light);--disclaimer-badge-bg:var(--disclaimer-badge-bg--light);--disclaimer-badge-text:var(--disclaimer-badge-text--light);--disclaimer-box-border-color:var(--disclaimer-box-border-color--light);--disclaimer-box-bg-color:var(--disclaimer-box-bg-color--light);--details-summary-border-color:var(--details-summary-border-color--light);--details-summary-bg-color:var(--details-summary-bg-color--light);--details-summary-bg-color-active:var(--details-summary-bg-color-active--light);--details-summary-font-color:var(--details-summary-font-color--light);--tag-border-color:var(--tag-border-color--light);--tag-bg-color:var(--tag-bg-color--light);--tag-bg-color-active:var(--tag-bg-color-active--light);--tag-font-color:var(--tag-font-color--light);--code-bg-color-inline:var(--code-bg-color-inline--light);--kbd-border-color:var(--kbd-border-color--light);--kbd-bg-color:var(--kbd-bg-color--light);--radio-container-badge-bg-color:var(--radio-container-badge-bg-color--light);--radio-container-border-color:var(--radio-container-border-color--light);--radio-container-bg-color:var(--radio-container-bg-color--light);--post-card-border-color:var(--post-card-border-color--light);--post-card-bg-color:var(--post-card-bg-color--light);--social-link-border-color:var(--social-link-border-color--light);--social-link-bg-color:var(--social-link-bg-color--light);--social-link-bg-color-active:var(--social-link-bg-color-active--light);--toc-dropdown-border-color:var(--toc-dropdown-border-color--light);--toc-dropdown-bg-color:var(--toc-dropdown-bg--light);--toc-dropdown-icon-color-filter-value:var(--toc-dropdown-icon-color-filter-value--light)}:where(html) theme-switch,[theme-preference=light] theme-switch{--text-color-1:var(--purple-950);--text-color-2:var(--purple-900);--dialog-border-color:var(--dialog-border-color--light);--dialog-bg-color:var(--dialog-bg-color--light);--themes-border-color:var(--themes-border-color--light);--circle-border-color:var(--circle-border-color--light);--circle-bg-color:var(--circle-bg-color--light);--circle-bg-color-checked:var(--circle-bg-color-checked--light);--circle-wave:var(--circle-wave--light);--control-color:var(--control-color--light);--control-interaction-color:var(--control-interaction-color--light);--checkbox-border-color:var(--checkbox-border-color--light);--checkbox-bg-color:var(--checkbox-bg-color--light);--checkbox-bg-color-checked:var(--checkbox-bg-color-checked--light);--checkmark-color:var(--checkmark-color--light)}:where(html) toc-observer,[theme-preference=light] toc-observer{--toc-item-border-default-color:var(--toc-item-border-default-color--light);--toc-item-border-active-color:var(--toc-item-border-active-color--light)}@media (prefers-color-scheme:dark){:where(html){color-scheme:dark;--surface-1:var(--deep-purple-1);--surface-2:var(--deep-purple-2);--surface-3:var(--deep-purple-3);--surface-4:var(--deep-purple-4);--surface-5:var(--deep-purple-5);--text-color-1:#fff;--header-bg-color:var(--header-bg-color--dark);--logo-bg-color:var(--logo-bg-color--dark);--glass-tint:var(--glass-tint--dark);--hr-color:var(--hr-color--dark);--disclaimer-badge-bg:var(--disclaimer-badge-bg--dark);--disclaimer-badge-border:var(--disclaimer-badge-border--dark);--disclaimer-badge-text:var(--disclaimer-badge-text--dark);--disclaimer-box-border-color:var(--disclaimer-box-border-color--dark);--disclaimer-box-bg-color:var(--disclaimer-box-bg-color--dark);--tag-border-color:var(--tag-border-color--dark);--tag-bg-color:var(--tag-bg-color--dark);--tag-bg-color-active:var(--tag-bg-color-active--dark);--tag-font-color:var(--tag-font-color--dark);--code-bg-color-inline:var(--code-bg-color-inline--dark);--kbd-border-color:var(--kbd-border-color--dark);--kbd-bg-color:var(--kbd-bg-color--dark);--radio-container-badge-bg-color:var(--radio-container-badge-bg-color--dark);--radio-container-border-color:var(--radio-container-border-color--dark);--radio-container-bg-color:var(--radio-container-bg-color--dark);--post-card-border-color:var(--post-card-border-color--dark);--post-card-bg-color:var(--post-card-bg-color--dark);--social-link-border-color:var(--social-link-border-color--dark);--social-link-bg-color:var(--social-link-bg-color--dark);--social-link-bg-color-active:var(--social-link-bg-color-active--dark);--toc-dropdown-border-color:var(--toc-dropdown-border-color--dark);--toc-dropdown-bg-color:var(--toc-dropdown-bg-color--dark);--toc-dropdown-icon-color-filter-value:var(--toc-dropdown-icon-color-filter-value--dark)}:where(html) theme-switch{--text-color-1:#fff;--text-color-2:#fff;--dialog-border-color:var(--dialog-border-color--dark);--dialog-bg-color:var(--dialog-bg-color--dark);--themes-border-color:var(--themes-border-color--dark);--circle-border-color:var(--circle-border-color--dark);--circle-bg-color:var(--circle-bg-color--dark);--circle-bg-color-checked:var(--circle-bg-color-checked--dark);--circle-wave:var(--circle-wave--dark);--control-color:var(--control-color--dark);--control-interaction-color:var(--control-interaction-color--dark);--checkbox-border-color:var(--checkbox-border-color--dark);--checkbox-bg-color:var(--checkbox-bg-color--dark);--checkbox-bg-color-checked:var(--checkbox-bg-color-checked--dark);--checkmark-color:#fff}toc-observer{--toc-item-border-default-color:var(--toc-item-border-default-color--dark);--toc-item-border-active-color:var(--toc-item-border-active-color--dark)}.social-links img{filter:brightness(0) invert(1)}header.opaque .logo{border-color:var(--surface-4)}}[theme-preference=dark]{color-scheme:dark;--surface-1:var(--deep-purple-1);--surface-2:var(--deep-purple-2);--surface-3:var(--deep-purple-3);--surface-4:var(--deep-purple-4);--surface-5:var(--deep-purple-5);--text-color-1:#fff;--header-bg-color:var(--header-bg-color--dark);--logo-bg-color:var(--logo-bg-color--dark);--glass-tint:var(--glass-tint--dark);--hr-color:var(--hr-color--dark);--disclaimer-badge-bg:var(--disclaimer-badge-bg--dark);--disclaimer-badge-border:var(--disclaimer-badge-border--dark);--disclaimer-badge-text:var(--disclaimer-badge-text--dark);--disclaimer-box-border-color:var(--disclaimer-box-border-color--dark);--disclaimer-box-bg-color:var(--disclaimer-box-bg-color--dark);--tag-border-color:var(--tag-border-color--dark);--tag-bg-color:var(--tag-bg-color--dark);--tag-bg-color-active:var(--tag-bg-color-active--dark);--tag-font-color:var(--tag-font-color--dark);--code-bg-color-inline:var(--code-bg-color-inline--dark);--kbd-border-color:var(--kbd-border-color--dark);--kbd-bg-color:var(--kbd-bg-color--dark);--radio-container-badge-bg-color:var(--radio-container-badge-bg-color--dark);--radio-container-border-color:var(--radio-container-border-color--dark);--radio-container-bg-color:var(--radio-container-bg-color--dark);--post-card-border-color:var(--post-card-border-color--dark);--post-card-bg-color:var(--post-card-bg-color--dark);--social-link-border-color:var(--social-link-border-color--dark);--social-link-bg-color:var(--social-link-bg-color--dark);--social-link-bg-color-active:var(--social-link-bg-color-active--dark);--toc-dropdown-border-color:var(--toc-dropdown-border-color--dark);--toc-dropdown-bg-color:var(--toc-dropdown-bg-color--dark);--toc-dropdown-icon-color-filter-value:var(--toc-dropdown-icon-color-filter-value--dark)}[theme-preference=dark] theme-switch{--text-color-1:#fff;--text-color-2:#fff;--dialog-border-color:var(--dialog-border-color--dark);--dialog-bg-color:var(--dialog-bg-color--dark);--themes-border-color:var(--themes-border-color--dark);--circle-border-color:var(--circle-border-color--dark);--circle-bg-color:var(--circle-bg-color--dark);--circle-bg-color-checked:var(--circle-bg-color-checked--dark);--circle-wave:var(--circle-wave--dark);--control-color:var(--control-color--dark);--control-interaction-color:var(--control-interaction-color--dark);--checkbox-border-color:var(--checkbox-border-color--dark);--checkbox-bg-color:var(--checkbox-bg-color--dark);--checkbox-bg-color-checked:var(--checkbox-bg-color-checked--dark);--checkmark-color:#fff}[theme-preference=dark] toc-observer{--toc-item-border-default-color:var(--toc-item-border-default-color--dark);--toc-item-border-active-color:var(--toc-item-border-active-color--dark)}[theme-preference=dark] .social-links img{filter:brightness(0) invert(1)}[theme-preference=dark] header.opaque .logo{border-color:var(--surface-4)}.header-links{display:flex;align-items:center;gap:var(--base-gap)}.header-links>li{list-style-type:none}#dropdown__title{display:flex;align-items:center;gap:calc(var(--base-gap)/ 2);padding:calc(var(--base-gap)/ 4) calc(var(--base-gap)/ 2);border-radius:var(--base-radius);border:2px solid hsla(281,53%,97%,.63);background-color:transparent}#dropdown__title img{height:1.5rem;filter:brightness(0) invert(var(--toc-dropdown-icon-color-filter-value))}.dropdown{position:relative;display:flex;justify-content:center;align-items:center}.dropdown:focus-within .dropdown__toc,.dropdown:hover .dropdown__toc{opacity:1;transform:rotateX(0) translateX(0);visibility:visible}.dropdown .dropdown__toc{display:grid;position:absolute;top:calc(100% - .25rem);right:0;transform:rotateX(-90deg) translateX(0);transform-origin:top center;opacity:.3;transition:280ms all ease-out;border-radius:4px;border:1px solid var(--toc-dropdown-border-color);background-color:var(--toc-dropdown-bg-color);box-shadow:0 .15em .25em rgba(0,0,0,.25);margin-block-start:var(--base-gap);padding:calc(var(--base-gap)/ 2);min-width:20ch}.dropdown .dropdown__toc a{color:var(text-1);display:block;padding:.5em}[theme-preference=dark] .post-tag.lit span{background-image:url("/img/flame-white.svg")}:where(a[href],area,button,input,label[for],select,summary,textarea,[tabindex]:not([tabindex*="-"])){cursor:pointer;touch-action:manipulation}html{block-size:100%;-webkit-text-size-adjust:none}hr{background-color:var(--hr-color);height:1px;border:0}body{display:flex;flex-direction:column;color:var(--text-color-1);font-family:Inter,sans-serif}:where(p,a,h1,h2,h3,h4,h5,h6){color:var(--text-color-1);overflow-wrap:break-word}:where(button,input,a[href],summary):where(:not(:active)):focus-visible{outline-offset:5px;transition:outline-offset 145ms ease}@media (prefers-reduced-motion:no-preference){a{transition:all .1s ease-in-out}a[href]:active{transform:scale(.95)}}.tmpl-home{display:flex;flex-direction:column;height:100vh}.tmpl-home .main-wrapper{flex:1;padding:var(--base-gap)}.main-wrapper{z-index:1}.main-wrapper main{margin:0 auto;width:100%;max-width:var(--site-width)}.intro{line-height:1.5;max-width:470px;text-align:justify}.social-links{--social-link-size:64px;display:flex;flex-wrap:wrap;gap:var(--base-gap);margin:var(--base-gap) 0;padding:0;list-style:none}.social-links li{border:1px solid var(--social-link-border-color);border-radius:50%;width:var(--social-link-size);height:var(--social-link-size);background-color:var(--social-link-bg-color)}.social-links li:is(:hover,:focus){background-color:var(--social-link-bg-color-active)}.social-links li a{display:flex;border-radius:50%;height:100%;padding:calc(var(--base-gap)/ 2)}.social-links li a img{width:100%;height:auto}aside.toc{grid-area:toc;position:sticky;top:calc(var(--header-height) + var(--base-gap) * 2);max-height:200px}.dropdown{display:none}@media screen and (max-width:750px){#main-wrapper.post{grid-template-areas:"main";grid-template-columns:1fr}aside.toc{display:none}aside#toc-mobile{display:block}}@media screen and (max-width:1199px){.dropdown{display:flex}}pre[class*=language-]{max-width:100%}footer{display:flex;align-items:center;justify-content:space-between;gap:var(--base-gap);padding:var(--base-gap);z-index:1}footer ul{display:flex;list-style-type:none;gap:var(--base-gap)}@media screen and (max-width:500px){footer{flex-direction:column-reverse;text-align:center}footer ul{flex-direction:column}}.post-tags{display:inline-flex;flex-wrap:wrap;gap:calc(var(--base-gap)/ 2 + 4px);padding:0;margin:0;list-style-type:none}.post-tags>li{display:inherit;align-items:center;height:36px}.post-tag{gap:calc(var(--base-gap)/ 2)}.post-tag.lit span{background-image:url("/img/flame.svg");background-size:contain;background-repeat:no-repeat;height:100%;aspect-ratio:4/5}.post-tag{display:flex;align-items:center;height:100%;padding:calc(var(--base-gap)/ 2) calc(var(--base-gap) * .75);border-radius:var(--tag-border-radius);text-decoration:none;background-color:var(--tag-bg-color);border:1px solid var(--tag-border-color);color:var(--tag-font-color);transform-origin:center}.post-tag img{height:100%}a.postlist-link{font-weight:500;font-size:1.2rem}.post-tag:is(:hover,:focus){background-color:var(--tag-bg-color-active)}.post-tag:active{transform:scale(.95)}.single-tag{display:inline-flex;margin-block-end:var(--base-gap)}.all-tags{margin:var(--base-gap) 0!important}.posts{display:grid;gap:var(--base-gap);grid-template-columns:repeat(auto-fill,minmax(300px,1fr));margin-block-start:var(--base-gap);margin-block-end:var(--base-gap);max-width:1280px}.postlist-item{--shadow-strength:1px;box-shadow:0 3px 5px -2px hsla(var(--shadow-color)/.04),0 7px 14px -5px hsla(var(--shadow-color)/.06),0 0 0 var(--shadow-strength) var(--post-card-border-color),0 7px 14px -5px hsla(var(--shadow-color)/.1);display:flex;flex-direction:column;gap:var(--base-gap);border-radius:var(--base-radius);border:1px solid var(--post-card-border-color);padding:var(--base-gap);background-color:var(--post-card-bg-color)}.postlist-item:focus-within{--shadow-strength:2px}.postlist-item header{display:flex;flex-direction:column}.post-tags{margin-top:auto}.disclaimer{position:relative;display:inline-block;border-radius:calc(var(--base-radius) * 1.5);border:1px solid var(--disclaimer-box-border-color);margin-block-start:calc(var(--base-gap) * 2);margin-block-end:var(--base-gap);max-width:500px;width:100%;padding:var(--base-gap);background-color:var(--disclaimer-box-bg-color);line-height:1.5}.disclaimer span{position:absolute;top:-20px;padding:4px 8px;border-radius:8px;border:1px solid var(--disclaimer-badge-border);background:var(--disclaimer-badge-bg);color:var(--disclaimer-badge-text)}.disclaimer ul{margin-block-end:0;padding-inline-start:2.5rem}details{position:relative;max-width:500px;width:100%;margin-block-end:var(--base-gap)}details[open] summary{position:absolute}details[open] summary:before{content:"";transform:rotate(180deg)}details[open]>#details-content{border-radius:calc(var(--base-radius) * 1.5);border:1px solid var(--disclaimer-box-border-color)}details summary{display:inline-flex;align-items:center;list-style:none;border-radius:calc(var(--base-radius) * 1.5);border:1px solid var(--details-summary-border-color);margin-inline-start:1px;margin-block-start:1px;padding:calc(var(--base-gap)/ 2) var(--base-gap);color:var(--details-summary-font-color);background-color:var(--details-summary-bg-color)}details summary:before{content:"";height:var(--detail-summary-icon-size);width:var(--detail-summary-icon-size);background-image:url("/img/icons/expand_more_FILL0_wght400_GRAD0_opsz48.svg");background-size:var(--detail-summary-icon-size);background-repeat:no-repeat;transform-origin:center;transition:transform 225ms cubic-bezier(.4, 0, .2, 1)}details summary:is(:hover,:focus){background-color:var(--details-summary-bg-color-active)}details #details-content{padding-block-start:calc(var(--base-gap) * 2.5);padding-block-end:var(--base-gap);padding-inline:var(--base-gap);background-color:var(--disclaimer-box-bg-color)}details #details-content p:last-child{margin-block-end:0}body{line-height:1.5;-webkit-font-smoothing:antialiased}.post{max-width:fit-content}.main-wrapper{display:flex;flex-direction:column;gap:3rem;margin:0 auto;padding-inline:clamp(1.375rem,1.2rem + 0.89vw,2rem)}aside{display:none}kbd{padding:3px 5px;border-radius:6px;background-color:var(--kbd-bg-color);box-shadow:0 2px 0 1px var(--kbd-border-color)}.sample-img{height:auto;width:100%}@media screen and (min-width:1200px){body:not(.content-page) .main-wrapper{display:grid;grid-template-columns:var(--site-width) 250px;grid-template-areas:"main toc"}aside{display:block}}header{margin-bottom:calc(var(--base-gap) * 2);line-height:normal}h1{margin-block-start:0;font-size:clamp(1.5rem, 1.29rem + 1.07vw, 2.25rem)}h2{font-size:clamp(1.25rem, 1.11rem + .71vw, 1.75rem)}h3{font-size:clamp(1.125rem, 1.09rem + .18vw, 1.25rem)}:is(h2,h3):not([slot]){margin:revert;scroll-margin-top:calc(var(--header-height) + var(--base-gap))}p{line-height:1.9;font-size:clamp(1rem, .96rem + .18vw, 1.125rem)}aside{--top:calc(var(--header-height) + var(--base-gap) * 5);position:sticky;top:var(--top);height:fit-content}ul:not(.post-tags,.footer-links,.header-links){line-height:2;margin:var(--base-gap) 0;padding:revert}blockquote,p{margin-block-end:var(--base-gap)}.post :is(h2,h3,h4,h5,h6){margin-block-start:clamp(1.5rem,3vw,2rem)}figure{margin-block-end:var(--base-gap);width:fit-content}figcaption{text-align:center}table{border-collapse:collapse}table,td,th{border:1px solid var(--text-color-1);text-align:left;padding:calc(var(--base-gap)/ 2) var(--base-gap)}code{overflow-x:auto}code:not([class^=language-]){border-radius:calc(var(--base-radius)/ 2);padding:calc(var(--base-gap)/ 4) calc(var(--base-gap)/ 2);background-color:var(--code-bg-color-inline)}blockquote{font-style:italic;border-radius:var(--base-radius);border:2px solid var(--surface-3);padding:var(--base-gap)}#toc-nav{display:none;top:var(--header-height);position:fixed;right:0}#toc-opener:is(:focus,:hover)+#toc-nav{display:block}toc-observer ol{list-style-type:none;line-height:1;padding:0}toc-observer ol:not(:first-child){padding-inline:0.85em}toc-observer a{display:flex;border-left:2px solid var(--toc-item-border-default-color);padding:calc(var(--base-gap)/ 2) var(--base-gap);color:var(--text-color-1);transition:all 50ms ease-in-out;text-decoration:none}toc-observer a:is(:hover,:focus,.toc-active){border-left-color:var(--toc-item-border-active-color)}[theme-preference=dark] .dropdown__toc{border:1px solid var(--surface-4);background-color:var(--surface-5)}theme-switch{--base-gap:16px}theme-switch:not(:defined) [slot]{display:none}:root{--color-bg:#2b2b2b;--color-color-primary:#f8f8f2;--color-color-secondary:#d4d0ab;--code-color-punctuation:#fefefe;--color-4:#ffa07a;--color-5:#00e0e0;--code-color-boolean:var(--color-5);--color-6:#abe338;--color-7:#ffd700}:is(code,pre):is([class*=language-]){color:var(--color-color-primary);background:0 0;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;tab-size:4;hyphens:none}pre[class*=language-]{padding:1em;margin-block-end:1em;border-radius:calc(var(--base-radius) * 2);max-width:100%;padding:var(--base-gap);max-width:100%;border-radius:8px;display:grid;grid-template-areas:"code";gap:var(--base-gap);align-items:center}:not(pre)>code[class*=language-],pre[class*=language-]{background:var(--color-bg)}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token:is(.comment,.prolog,.doctype,.cdata){color:var(--color-color-secondary)}.token.punctuation{color:var(--code-color-punctuation)}.token:is(.property,.tag,.constant,.symbol,.deleted){color:var(--color-4)}.token:is(.boolean,.number){color:var(--color-5)}.language-css .token.string,.style .token.string,.token:is(.entity,.keyword,.operator,.url,.variable){color:var(--color-5)}.token:is(.selector,.attr-name,.string,.char,.builtin,.inserted){color:var(--color-6)}.token:is(.atrule,.attr-value,.function,.regex,.important){color:var(--color-7)}.token:is(.important,.bold){font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{color:windowText;background:window}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token:is(.atrule,.attr-value,.function,.keyword,.operator,.selector){font-weight:700}.token:is(.attr-value,.comment,.doctype,.function,.keyword,.operator,.property,.string){color:highlight}.token:is(.attr-value,.url){font-weight:400}}
    
  </style>


  <script>
  // Read theme preference from localStorage
  const themePreference = localStorage.getItem('theme-preference');
  // Set theme if one is present in localStorage
  if (themePreference !== null) {
    document
      .querySelector('html')
      .setAttribute('theme-preference', themePreference);
  }
</script>


  <link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="Tony Spegel">
  <link rel="alternate" href="/feed/feed.json" type="application/json" title="Tony Spegel">

  
  
    
    <script type="module" src="/js/theme-switch.js"></script>
  
    
    <script type="module" src="/js/index.js"></script>
  
    
    <script type="module" src="/js/post.js"></script>
  
  <link rel="icon" href="/favicon.svg">
</head>

  <body>
    
<theme-switch>
  <h2 slot="heading">Theme Auswahl</h2>
  <span slot="sub-heading">Wähle ein Theme für die Website</span>
  <a href="datenschutzerklaerung/#auswertung-des-verhaltens-von-besucherinnen-und-besuchern-cookies"
    id="read-more"
    slot="read-more"
    target="_blank"
    title="Was wird gespeichert?"
  >
    ?
  </a>
  <span slot="close-caption">Schließen</span>
</theme-switch>

    <header id="site-header">
  <nav aria-label="Hauptnavigation">
    
      <a class="logo" href="/" title="Zur Startseite">
        <img src="/tsp_icon.svg" alt="Tony Spegel Logo">
      </a>
    

    <ul class="header-links">
      
      <li class="dropdown">
        <button type="button"id="dropdown__title">
          Inhalt
          <img src="/img/icons/toc_FILL0_wght400_GRAD0_opsz48.svg" aria-hidden="true" >
        </button>

        <div class="dropdown__toc" id="drop-down-container">
          <toc-observer observeParent>
            <div slot="toc">
              <nav class="toc">
                <ol>
                    
                    <li><a href="#motivation">Motivation</a>
            		</li>

                    <li><a href="#implementation">Implementation</a>
            
                <ol>
                    
                    <li><a href="#a-signature">A: Signature</a>
            		</li>

                    <li><a href="#b-runtime-check">B: Runtime check</a>
            		</li>

                    <li><a href="#c-building-a-new-getter">C: Building a new getter</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#fazit-and-ausblick">Fazit & Ausblick</a>
            		</li>
                </ol>
            </nav>
            </div>
          </toc-observer>
        </div>
      </li>
      
      <li>
        <button id="btn-theme-selection" title="Farbschema auswählen"></button>
      </li>
    </ul>
  </nav>
</header>

    <div class="glass"></div>
    <div class="bubble"></div>
    <div class="bubble-2"></div>
    <div class="main-wrapper post">
      <main>
        <div id="sentinel-element"></div>
        <header>
          <time class="article-date" datetime="2023-09-20">
            20.09.2023
          </time>
          <h1>Einen Decorator für Inhalte eines Slots entwickeln</h1>
          <ul class="post-tags">
            
              
              <li>
                
  
      <a href="/tags/decorator/" class="post-tag">#Decorator</a>
  

              </li>
            
              
              <li>
                
  
      <a href="/tags/typescript/" class="post-tag">#TypeScript</a>
  

              </li>
            
              
              <li>
                
  
      <a href="/tags/lit/" class="post-tag lit">
        #Lit
        <span></span>
      </a>

    

              </li>
            
              
              <li>
                
  
      <a href="/tags/web-components/" class="post-tag">#Web Components</a>
  

              </li>
            
              
              <li>
                
  
      <a href="/tags/upcoming/" class="post-tag upcoming">
        <span aria-hidden="true">🔮</span>
      </a>

    

              </li>
            
          </ul>
        </header>

        <section>
<h2 id="motivation"><a class="header-anchor" href="#motivation">Motivation</a></h2>
<p>Vor einer Weile habe ich eine Web Component <a href="/blog/toc-observer">entwickelt</a>, welche CSS-Klassen zu Links in einem Inhaltsverzeichnis<br>
je nach Sichtbarkeit der zugehörigen Elemente im Viewport hinzufügen/entfernen kann.</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>toc-observer</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>toc<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#tethys<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Tethys<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><br>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>#mimas<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Mimas<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">></span></span><br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>toc-observer</span><span class="token punctuation">></span></span><br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>tethys<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mimas<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">></span></span></code></pre>
<p>Web Components bieten den Vorteil, dass diese so konfiguriert werden können, dass sie in sich geschlossen sind und von außen nur über klar definierte Schnittstellen beeinflusst werden können.</p>
<p>Zu diesen Schnittstellen gehört das <code>&lt;slot&gt;</code>-Element bzw. Attribut. Es verhält sich als ein Platzhalter, welcher eigenes Markup, in dem Fall das Inhaltsverzeichnis meiner Posts, in die Component aufnehmen kann. Um nun den &quot;Inhalt&quot; (die Links) des zum Slot zugewiesenen Element ( das <code>&lt;ul&gt;</code>) verarbeiten zu können, benutze ich in einem ersten Schritt den zu Lit gehörenden <code>@queryAssignedElements</code>-<a href="https://lit.dev/docs/api/decorators/#queryAssignedElements" target="_blank" rel="noopener noreferrer">Decorator</a>:</p>
<pre class="language-ts"><code class="language-ts"><span class="token decorator"><span class="token at operator">@</span><span class="token function">customElement</span></span><span class="token punctuation">(</span><span class="token string">'toc-observer'</span><span class="token punctuation">)</span><br><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TocObserver</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span><br>  <span class="token decorator"><span class="token at operator">@</span><span class="token function">queryAssignedElements</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>slot<span class="token operator">:</span> <span class="token string">'toc'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><br>  <span class="token keyword">private</span> _tocList<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>HTMLUListElement<span class="token operator">></span><span class="token punctuation">;</span><br><br>  <span class="token keyword">private</span> <span class="token keyword">get</span> <span class="token function">_tocListItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> HTMLAnchorElement<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">null</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_tocList<span class="token operator">?.</span>length<br>      <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>_tocList<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">querySelectorAll</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLAnchorElement<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">'[href^="#"]'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><br>      <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Bei der Nutzung dieses Decorators bin ich zunächst darüber gestolpert, dass ausschließlich die zum Slot zugewiesenen Elemente zurückgegeben werden - was so aber auch Sinn ergibt. Deswegen nutze ich in einem weiteren Schritt auch einen Getter, welcher mit einem <code>querySelectorAll</code> die enthaltenen Links zurückgibt. Das ist nicht großartig kompliziert aber hat mich dann motiviert meinen eigenen Decorator zu schreiben der am Ende beide Schritte in einem vereint:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">DecoElement</span> <span class="token keyword">extends</span> <span class="token class-name">HTMLElement</span> <span class="token punctuation">{</span><br>  <span class="token decorator"><span class="token at operator">@</span><span class="token function">queryAssignedElementContent</span></span><span class="token punctuation">(</span><span class="token punctuation">{</span> selector<span class="token operator">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span> slot<span class="token operator">:</span> <span class="token string">'list'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><br>  accessor #tocLinks<span class="token operator">!</span><span class="token operator">:</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>HTMLAnchorElement<span class="token operator">></span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
</section>
<section>
<h2 id="implementation"><a class="header-anchor" href="#implementation">Implementation</a></h2>
<details>
   <summary>Gut zu wissen: Decorators</summary>
   <div id="details-content">
    <p>
      Decorators ermöglichen es, das Verhalten von Classes und deren Member zu ändern. Dazu zählt beispielsweise das Hinzufügen von Metadaten, die Erweiterung von Funktionalität oder die Validierung von Daten.
    </p>
    <p>
      Es ist wichtig zu beachten, dass hier Standard Decorators gemeint sind, die derzeit als <a href="https://github.com/tc39/proposal-decorators" target="_blank" rel="noopener noreferrer">Stage 3 Proposal</a> existieren. (Legacy) Decorators können bereits seit längerem genutzt werden und entsprechen einem vorherigen Entwurf. Obwohl Standard Decorators derzeit von keinem Browser unterstützt werden, können sie bereits mit Compilern wie TypeScript (>= 5.x.x) oder Babel genutzt werden.
    </p>
   </div>
</details>
<p>Meine Implementation basiert auf dem derzeit aktuellen Stage 3 Proposal und unterscheidet sich somit von den bisher bereits verfügbaren Legacy Decorators (siehe <em>Gut zu wissen</em>). Den aktuellen Status des Proposals verfolge ich schon eine Weile und habe dann schließlich im Mai mit der Umsetzung begonnen. Eine kleine Einschränkung direkt vorab: zum jetzigen Zeitpunkt ist es noch nicht mögliche beide Arten von Decorators parallel in Lit zu nutzen - das ist aber bereits in Arbeit.</p>
<p>Die eigentliche Logik im Code ist, wie in der <a href="#motivation">Motivation</a> zu sehen, überschaubar. Die Herausforderung für mich lag eher darin, ein so umfassendes, technisches Dokument wie das Proposal komplett zu lesen und so weit zu verstehen, dass ich damit arbeiten konnte. Viel gelernt habe ich im Austausch mit <a href="https://github.com/vdegenne" target="_blank" rel="noopener noreferrer">Valentin Degenne</a>, welchen ich über den <a href="https://discord.gg/eMaSX7G5" target="_blank" rel="noopener noreferrer">Lit Discord</a> kennenlernen durfte und mich bei Fragen immer wieder unterstützt hat.</p>
<p>Nach einer Weile habe ich dann verstanden, dass ich einen <code>Class Auto-Accessor</code> benötige. Diese werden mit dem neuen <code>accessor</code> Keyword ausgezeichnet.</p>
<p>Eine Auto-accessor definiert automatisch ein Getter/Setter-Paar so dass:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span><br>  accessor x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>grob zu folgendem übersetzt wird:</p>
<pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span><br>  #x <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// '#' marks private fields in JS</span><br><br>  <span class="token keyword">get</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#x<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><br>  <span class="token keyword">set</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">this</span><span class="token punctuation">.</span>#x <span class="token operator">=</span> val<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Auf diese Art funktioniert das nur für einfache Felder. Das stellt aber kein Problem dar, weil diese sich weiter anpassen lassen. Grob ausgedrückt soll der Decorator dieses so dekorierte Feld nehmen und mit einem angepassten Getter ersetzen in dem es mit zusätzlicher Logik angereichert wird.</p>
<p>Meine Implementation basiert auf Grund der Nähe auch stark auf dem <code>queryAssignedElements</code>-<a href="https://github.com/lit/lit/blob/main/packages/reactive-element/src/decorators/query-assigned-elements.ts#L79" target="_blank" rel="noopener noreferrer">Decorators</a>:</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">// A: Signature</span><br><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token generic-function"><span class="token function">queryAssignedElementContent</span><span class="token generic class-name"><span class="token operator">&lt;</span><br>  <span class="token constant">T</span> <span class="token keyword">extends</span> Element<span class="token punctuation">,</span> <span class="token comment">// The `this` type to which the target applies</span><br>  <span class="token constant">E</span> <span class="token keyword">extends</span> Element <span class="token comment">// The property type for the class `accessor` field.</span><br><span class="token operator">></span></span></span><span class="token punctuation">(</span>options<span class="token operator">:</span> QueryAssignedElementContentOptions<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><br>    _target<span class="token operator">:</span> ClassAccessorDecoratorTarget<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">E</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">,</span><br>    <span class="token comment">// Context object containing information about the value being decorated</span><br>    context<span class="token operator">:</span> ClassAccessorDecoratorContext<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">E</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><br>  <span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token comment">// B: Runtime check for better DX</span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span>kind <span class="token operator">!==</span> <span class="token string">'accessor'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Only supported on class accessors'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>    <span class="token punctuation">}</span><br><br>    <span class="token comment">// C: Building a new getter</span><br>    <span class="token keyword">const</span> result<span class="token operator">:</span> ClassAccessorDecoratorResult<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">E</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token operator">=</span> <span class="token punctuation">{</span><br>      <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">const</span> <span class="token punctuation">{</span> shadowRoot <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span> <span class="token comment">// Root node within a shadow dom</span><br>        <span class="token keyword">const</span> <span class="token punctuation">{</span> selector<span class="token punctuation">,</span> slot <span class="token punctuation">}</span> <span class="token operator">=</span> options<span class="token punctuation">;</span> <span class="token comment">// Extract options</span><br><br>        <span class="token comment">// C1: Construct a slot element selector</span><br>        <span class="token keyword">const</span> slotSelector <span class="token operator">=</span> slot <span class="token operator">?</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">slot[name=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>slot<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">]</span><span class="token template-punctuation string">`</span></span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">slot:not([name])</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span><br>        <span class="token comment">// C2: Select a slot element</span><br>        <span class="token keyword">const</span> slotElement <span class="token operator">=</span><br>          shadowRoot<span class="token operator">?.</span><span class="token generic-function"><span class="token function">querySelector</span><span class="token generic class-name"><span class="token operator">&lt;</span>HTMLSlotElement<span class="token operator">></span></span></span><span class="token punctuation">(</span>slotSelector<span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">// C3: Get slot assigned elements</span><br>        <span class="token keyword">const</span> assignedElements <span class="token operator">=</span> slotElement<span class="token operator">?.</span><span class="token function">assignedElements</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>          <span class="token operator">...</span>options<span class="token punctuation">,</span><br>          flatten<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>        <span class="token comment">// C4: Query slot for its content</span><br>        <span class="token keyword">const</span> slotContent <span class="token operator">=</span> assignedElements<span class="token operator">?.</span>length<br>          <span class="token operator">?</span> <span class="token punctuation">[</span><span class="token operator">...</span>assignedElements<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token generic-function"><span class="token function">querySelectorAll</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">E</span><span class="token operator">></span></span></span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span><span class="token punctuation">]</span><br>          <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br><br>        <span class="token keyword">return</span> slotContent<span class="token punctuation">;</span><br>      <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">}</span><span class="token punctuation">;</span><br>    <span class="token keyword">return</span> result<span class="token punctuation">;</span><br>  <span class="token punctuation">}</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<section>
<h3 id="a-signature"><a class="header-anchor" href="#a-signature">A: Signature</a></h3>
<p>Ein <code>ClassAccessorDecorator</code> gibt ein <code>ClassAccessorDecoratorResult</code> zurück, welches als Parameter ein <code>target</code> (hier ungenutzt) sowie <code>context</code> erwartet. Um dieselben Konfigurationsmöglichkeiten wie der <code>queryAssignedElements</code> zu bieten, definiere dieses Interface:</p>
<pre class="language-ts"><code class="language-ts"><span class="token keyword">interface</span> <span class="token class-name">QueryAssignedElementContentOptions</span> <span class="token punctuation">{</span><br>  <span class="token comment">/**<br>   * The selector used to query the content of the slot's assigned elements.<br>   * Must be a valid CSS selector string.<br>   * ```html<br>   * &lt;ul slot="list"><br>   *   &lt;li>Tethys&lt;/li> // ← use a selector to query these elements<br>   * &lt;/ul><br>   * ```<br>   */</span><br>  selector<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>  <span class="token comment">/**<br>   * The name of the slot to query elements from.<br>   * ```html<br>   * &lt;ul slot="list">&lt;/ul><br>   *           ^<br>   * ```<br>   * @optional<br>   */</span><br>  slot<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Lediglich <code>slot</code> definiere ich als optional, da ich später ohne Angabe eines Namens auf den Default Slot zurückgreife.</p>
</section>
<section>
<h3 id="b-runtime-check"><a class="header-anchor" href="#b-runtime-check">B: Runtime check</a></h3>
<p>Um nicht nur in TypeScript sondern auch in JavaScript etwas mehr Sicherheit zu bieten, habe ich noch einen Check integriert, um sicherzustellen, dass der Decorator nur an der richtigen Stelle, nämlich an einer Class Property, verwendet werden kann. Wäre es nicht für diesen Check wäre auch das <code>context</code>-Objekt unbenutzt.</p>
</section>
<section>
<h3 id="c-building-a-new-getter"><a class="header-anchor" href="#c-building-a-new-getter">C: Building a new getter</a></h3>
<p>Der Kern dieses Decorators ist der neue Getter. Im ersten Schritt (<strong>C1</strong>) konstruiere ich den Slot-Selektor für <strong>C2</strong> und greife auf den Standard-Slot zurück, sollte kein <code>name</code> übergeben werden. Eine Web Component kann aber muss nämlich nicht nur aus einem Slot-Element bestehen. Inklusive <strong>C3</strong> ist die Implementierung noch nah am Vorbild denn erst in <strong>C4</strong> extrahiere ich den für mich eigentlich interessanten Inhalt.</p>
</section>
</section>
<section>
<h2 id="fazit-and-ausblick"><a class="header-anchor" href="#fazit-and-ausblick">Fazit &amp; Ausblick</a></h2>
<p>Auch wenn ich zum jetzigen Stand meinen Decorator noch nicht in meinen Projekten nutzen kann, habe ich hier eine Menge gelernt und wertvolles Feedback einholen können sowohl was die Implementierung aber auch insbesondere das Arbeiten mit anspruchsvolleren Spezifikationen betrifft.<br>
Vor allem das Ganze typsicher umzusetzen und Generics über mehrere Ebenen hinweg zu nutzen war nicht ganz ohne. Auch spannend würde ich es bezeichnen, dass zur Zeit der Umsetzung wenig bis eher keine anderen Posts existierten, die genau diese Art an Decorators behandelt haben.</p>
<p>Das Ganze sehe ich im Moment noch als experimentell aber als guten ersten Schritt für weitere Entwicklungen an. Logik hinter einem Decorator zu verstecken ist natürlich auch immer etwas <span aria-hidden="true">✨</span>Magie<span aria-hidden="true">✨</span>, da es auf den ersten Blick nicht ersichtlich ist, was konkret passiert. Da hier aber der Anwendungsfall relativ kompakt ist, sehe ich das als kein großes Problem an.</p>
<p>Jetzt bleibt meinerseits lediglich zu warten, bis seitens Lit die Unterstützung für &quot;Hybrid&quot;-Decorators kommt und Browser anfangen Standard-Decorators zu implementieren. In meinem nächsten Post wird es um einen weiteren Decorator und dazu passenden Anwendungsfall gehen.</p>
</section>

      </main>

      
        <aside>
          <toc-observer observeParent>
            <div slot="toc">
              <nav class="toc">
                <ol>
                    
                    <li><a href="#motivation">Motivation</a>
            		</li>

                    <li><a href="#implementation">Implementation</a>
            
                <ol>
                    
                    <li><a href="#a-signature">A: Signature</a>
            		</li>

                    <li><a href="#b-runtime-check">B: Runtime check</a>
            		</li>

                    <li><a href="#c-building-a-new-getter">C: Building a new getter</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#fazit-and-ausblick">Fazit & Ausblick</a>
            		</li>
                </ol>
            </nav>
            </div>
          </toc-observer>
        </aside>
      
    </div>

    
  
  <script>
    if ('serviceWorker' in navigator) {
      navigator
        .serviceWorker
        .register('/sw.js');
    }
  </script>


    <footer>
  <span id="copyright">
    © Tony Spegel
    2023
  </span>
  <ul class="footer-links">
    
      <li>
        <a href="/impressum/">Impressum</a>
      </li>
    
      <li>
        <a href="/datenschutzerklaerung/">Datenschutzerklärung</a>
      </li>
    
      <li>
        <a href="/barrierefreiheit/">Barrierefreiheit</a>
      </li>
    
  </ul>
</footer>

  </body>
</html>
